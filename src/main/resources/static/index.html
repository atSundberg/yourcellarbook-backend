<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="yourcellarbook.com - Your pocket wine tracker" />

    <title>Your Cellar Book - Track your wines</title>

    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" /> -->
    <link href="assets/css/all.css" rel="stylesheet" />
    <link rel="stylesheet" href="assetsybulma/css/mystyles.css" />
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <script src="pockb/dist/pocketbase.umd.js"></script>
    <script src="js/main.js"></script>
    
  </head>
  <body>
    <!-- <div class="vector bottom">
      <svg viewBox="0 0 40 100" preserveAspectRatio="none">
        <defs>
          <linearGradient id="grad" , x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0.3" stop-color="#aa5E93" />
            <stop offset="0.7" stop-color="#4784FF" />
          </linearGradient>
        </defs>
        <polygon points="0,25 100,0 0,0 0,20" />
      </svg>
    </div> -->

    <div x-data="account">
      <section class="navigation" >
        <nav class="navbar" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
            <a class="navbar-item ml-2" href="http://yourcellarbook.com">
              <img
                src="assets/images/YourCellarBook_Logo_v3.png"
                alt="Your Cellar Book - Logo"
                style="max-height: 100px" />
            </a>

            <a
              role="button"
              class="navbar-burger"
              @click="showNav = !showNav"
              aria-label="menu"
              aria-expanded="false"
              data-target="navbarContent"
              x-bind:class="{'is-active' : showNav}">
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>

          <div id="navbarContent" class="navbar-menu" x-bind:class="{'is-active' : showNav}">
            <div class="navbar-end">
              <div class="navbar-item">
                <div class="buttons" x-show="!isSignedIn">
                  <a class="button is-link" @click="accountModal.userFlow = 'signUp'">
                    <strong>Sign up</strong>
                  </a>
                  <a class="button is-outlined is-link" @click="accountModal.userFlow = 'logIn'"> Log in </a>
                </div>
              </div>
              <div class="navbar-item">
                <div class="buttons" x-show="isSignedIn">
                  <a class="button is-outlined is-link" @click="logout"> Log Out </a>
                </div>
              </div>
            </div>
          </div>
        </nav>

        <!-- <div x-show="userFlow === 'logInConfirmation'" x-data="ConfirmationComponent()"> -->

        <!--  -->

        <!-- Modal -->
        <!-- <div class="modal" x-bind:class="{ 'is-active': modalOpen }" x-data="LogInComponent()"> -->
        <!-- x-bind:class="{ 'is-active' : $store.components.userFlowModal.userFlow === 'logIn' }" -->

        <!-- x-data="LogInComponent()" -->
        <div class="modal" x-bind:class="{ 'is-active' : accountModal.userFlow === 'logIn' }">
          <div class="modal-background" @click="accountModal.userFlow = ''"></div>
          <div class="modal-card">
            <header class="modal-card-head">
              <p class="modal-card-title has-text-link-dark">Log In</p>
              <button class="delete" aria-label="close" @click="accountModal.userFlow = ''"></button>
            </header>
            <form @submit.prevent="login()">
              <section class="modal-card-body">
                <div class="field">
                  <label class="label">Email</label>
                  <div class="control">
                    <input
                      type="email"
                      class="input"
                      name="email"
                      required
                      placeholder="Email address"
                      x-model="formData.email" />
                  </div>
                </div>
                <div class="field">
                  <label class="label">Password</label>
                  <div class="control">
                    <input
                      type="password"
                      class="input"
                      name="pwd"
                      required
                      placeholder="Password"
                      x-model="formData.password" />
                  </div>
                </div>
                <div class="field has-text-centered">
                  <a href="#">Reset password</a>
                </div>
                <div class="field has-text-centered">
                  Not a member? <a @click="accountModal.userFlow = 'signUp'">Sign up</a>
                </div>
              </section>
              <footer class="field modal-card-foot">
                <button @click="login()" class="button is-link is-fullwidth">Log In</button>
                <button @click="accountModal.userFlow = ''" class="button is-light is-fullwidth" type="button">
                  Cancel
                </button>
                <!-- <button class="button" @click="userFlow = ''">Close</button> -->
                <div class="help text-is-link" x-text="formMessage.loginMessage"></div>
              </footer>
            </form>
          </div>
        </div>

        <!-- Sign Up -->
        <div class="modal modalSU" x-bind:class="{ 'is-active' : accountModal.userFlow === 'signUp' }"

        >
          <div class="modal-background" @click="accountModal.userFlow = ''"></div>
          <div class="modal-card">
            <header class="modal-card-head">
              <p class="modal-card-title has-text-link-dark">Sign Up</p>
              <button class="delete" aria-label="close" @click="accountModal.userFlow = ''"></button>
            </header>
            <form @submit.prevent="signup">
              <section class="modal-card-body" x-show="isSignedUp">
                <div class="notification is-warning" x-text="formMessage.signupMessage"></div>
              </section>
              <section class="modal-card-body" x-show="!isSignedUp">
                <div class="field is-horizontal">
                  <div class="field-label is-normal">
                    <label class="label">Name</label>
                  </div>
                  <div class="field-body">
                    <div class="field">
                      <p class="control is-expanded has-icons-left">
                        <input class="input" type="text" placeholder="First" x-model="formData.firstName" />
                        <span class="icon is-small is-left">
                          <i class="fas fa-user"></i>
                        </span>
                      </p>
                    </div>
                    <div class="field">
                      <p class="control is-expanded">
                        <input class="input" type="text" placeholder="Last" x-model="formData.lastName" />
                      </p>
                    </div>
                  </div>
                </div>

                <div class="field is-horizontal">
                  <div class="field-label is-normal">
                    <label class="label">Email</label>
                  </div>
                  <div class="field-body">
                    <div class="field">
                      <div class="control has-icons-left">
                        <input
                          type="email"
                          class="input"
                          name="email"
                          required
                          placeholder="Email address"
                          x-model="formData.email" />
                        <span class="icon is-small is-left">
                          <i class="fas fa-envelope"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="field is-horizontal">
                  <div class="field-label is-normal">
                    <label class="label">Password</label>
                  </div>
                  <div class="field-body">
                    <div class="field">
                      <div class="control has-icons-left">
                        <input
                          type="password"
                          class="input"
                          name="pwd"
                          required
                          placeholder="Password"
                          x-model="formData.password" />
                        <span class="icon is-small is-left">
                          <i class="fas fa-key"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="field is-horizontal">
                  <div class="field-label is-normal"></div>
                  <div class="field-body">
                    <div class="field">
                      <div class="control has-icons-left">
                        <input
                          type="password"
                          class="input"
                          name="pwd"
                          required
                          placeholder="Confirm Password"
                          x-model="formData.passwordConfirm" />
                        <span class="icon is-small is-left">
                          <i class="fas fa-key"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="field has-text-centered">
                  Already a member?
                  <a @click="accountModal.userFlow = 'logIn'"> Log In</a>
                </div>
              </section>
              <footer x-show="!isSignedUp" class="field modal-card-foot">
                <button @click="signup()" class="button is-link is-fullwidth">Sign Up</button>
                <button @click="accountModal.userFlow = ''" class="button is-light is-fullwidth" type="button">
                  Cancel
                </button>
              </footer>
              <div
                x-show="formMessage.signupMessage != '' && !isSignedUp"
                class="help is-danger"
                x-text="formMessage.signupMessage"></div>
            </form>
          </div>
        </div>
        <!-- <button @click="loginBtn()" class="button is-success">Log in</button> -->
        <!-- <button @click="addOrGetRegion('Bordeaux', 'France')" class="button is-success">add producer</button> -->
        <!-- <button @click="addWineTest" class="button is-success">add wine</button> -->

        <section x-effect="isSignedIn, value => consol.log('Signed in am I?', value)" x-show="isSignedIn">
          <div class="tabs is-centered">
            <ul>
              <li @click="selectedPage = 'history'" :class="selectedPage == 'history'   ? 'is-active' : ''">
                <a>History</a>
              </li>
              <li @click="selectedPage = 'home'" :class="selectedPage == 'home'    ? 'is-active' : ''">
                <a>View Full Collection</a>
              </li>
              <!-- <li @click="selectedPage = 'pairWine'" :class="selectedPage == 'pairWine'    ? 'is-active' : ''">
              <a>Pair Wine</a>
            </li> -->
              <li @click="selectedPage = 'addWine'" :class="selectedPage == 'addWine'   ? 'is-active' : ''">
                <a>Add Wine</a>
              </li>
            </ul>
          </div>
        </section>
      </section>

      <div class="background-section1 section is-fullheight" >
        <section x-show="!isSignedIn && selectedPage == 'home'">
          <div class="container">
            <div style="margin-bottom: 10px"></div>
            <div class="columns">
              <div class="column is-narrow"></div>
              <div class="column is-narrow"></div>
              <div class="column is-two-thirds is-fullwidth">
                <span class="has-text-link is-size-4-mobile is-size-1-tablet is-fullwidth">
                  YOUR <span class="has-text-black has-text-weight-bold">INTELLIGENT</span> <br />
                  WINE TRACKING SYSTEM<br
                /></span>
                <span class="has-text-link is-size-7-mobile is-size-5-tablet is-fullwidth">
                  For you who want to remember which wines you store, or who need help choosing tonight&#8217;s wine
                  pairing.
                </span>
              </div>
              <!-- <div class="column is-one-third">
              <div class="box p-3">
                <img
                  src="assets/images/wine-cellar-moldova.webp"
                  alt="View of a wine collection"
                  style="filter: grayscale(100%)" />
              </div>
            </div> -->
            </div>
            <div class="has-text-centered">
              <!-- <span class="is-size-4-mobile is-size-1-tablet" style="font-size: 59pt"> Welcome to Your Cellar Book</span> -->
            </div>
            <div class="is-hidden-mobile" style="margin-bottom: 80px"></div>
            <div class="is-hidden-tablet" style="margin-bottom: 20px"></div>
          </div>
        </section>
      </div>

      <!-- ###--------------------- -->

      <!-- Old version of Landing page introduction to the service -->

      <!-- <div class="columns">
          <div class="column is-narrow"></div>
          <div class="column is-narrow"></div>
          <div class="column is-narrow"></div>
          <div class="column">
            <div class="box">
            <div class="columns is-variable is-8 mb-5">
              <div class="column">
                <div class="columns">
                  <div class="column is-narrow">
                      <span>
                        <i class="bx bx-search-alt-2 bx-md" style="color: #0d2a00"></i>
                      </span>
                    </div>
                  <div class="column">
                    <span class="has-text-link is-size-3-mobile" style="font-size: 24pt"> Track your wines<br /> </span>
                    <span class="has-text-link is-size-6-mobile">
                      No need to ever think about which wines you store in your closet.
                    </span>
                  </div>
                </div>
              </div>

              <div class="column">
                <div class="columns">
                  <div class="column is-narrow">
                      <span>
                        <i class="bx bx-help-circle bx-md" style="color: #0d2a00"></i>
                      </span>
                    </div>
                  <div class="column">
                    <span class="has-text-link is-size-3-mobile" style="font-size: 24pt">
                      Get pairing advise<br />
                    </span>
                    <span class="has-text-link is-size-6-mobile">
                      Ask your personal pocket-sommelier which wine you should pair with tonight's dinner.
                    </span>
                  </div>
                </div>
              </div>
              <div class="column">
                <div class="columns">
                  <div class="column is-narrow">
                      <span>
                        <i class="bx bx-memory-card bx-md" style="color: #0d2a00"></i>
                      </span>
                    </div>
                  <div class="column">
                    <span class="has-text-link is-size-3-mobile" style="font-size: 24pt"> Do not forget<br /> </span>
                    <span class="has-text-link is-size-6-mobile">
                      Remember which wines you've enjoyed (or which wines to avoid).
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="container mt-5">
              <button @click="accountModal.userFlow = 'signUp'" class="button is-large is-fullwidth">
                Try it out!
              </button>
            </div>
            </div>
          </div>
          <div class="column is-narrow"></div>
          <div class="column is-narrow"></div>
          <div class="column is-narrow"></div>
        </div>
      </section> -->

      <!-- ###--------------------- -->

      <div
        class="background-section2 section is-fullheight"
        @scroll.window.throttle="isTransitioning = true"
        
        x-bind:class="{ 'changed': isTransitioning }">
        <div class="container">
          <div class="columns">
            <!-- First Column -->
            <div class="column">
              <div class="box is-size-5">
                <h1 class="title">Track your wines</h1>
                <p>No need to ever think about which wines you store in your &lsquo;closet&rsquo;.</p>
              </div>
            </div>

            <!-- Second Column -->
            <div class="column">
              <div class="box is-size-5">
                <h1 class="title">Get pairing advise</h1>
                <p>Ask your personal pocket-sommelier which wine you should pair with tonight's dinner.</p>
              </div>
            </div>

            <!-- Third Column -->
            <div class="column">
              <div class="box is-size-5">
                <h1 class="title">Do not forget</h1>
                <p>Remember which wines you've enjoyed (or which wines to avoid).</p>
              </div>
            </div>
          </div>

          <!-- New Row for Button -->
          <div class="columns">
            <div class="column"></div>
            <div class="column is-three-fifths">
              <button
                @click="myFunction()"
                class="button is-outlined is-fullwidth is-success is-large is-rounded">
                Try it out
              </button>
            </div>
            <div class="column"></div>
          </div>
        </div>

        <!-- <div class="columns">
        <div class="column"></div>
        <div class="column is-one-fifth">
          <div>
            <span class="is-size-3-mobile" style="font-size: 24pt"> Track your wines<br /> </span>
            <span class="is-size-6-mobile"> No need to ever think about which wines you store in your closet. </span>
          </div>
        </div>

        <div class="column is-narrow"></div>

        <div class="column is-one-fifth">
          <div>
            <span class="is-size-3-mobile" style="font-size: 24pt"> Get pairing advise<br /> </span>
            <span class="is-size-6-mobile">
              Ask your personal pocket-sommelier which wine you should pair with tonight's dinner.
            </span>
          </div>
        </div>

        <div class="column is-narrow"></div>

        <div class="column is-one-fifth">
          <div>
            <span class="is-size-3-mobile" style="font-size: 24pt"> Do not forget<br /> </span>
            <span class="is-size-6-mobile"> Remember which wines you've enjoyed (or which wines to avoid). </span>
          </div>
        </div>
      </div>

      <div class="container mt-5">
        <div class="columns">
          <div class="column is-four-fifths">
            
            <button
              @click="accountModal.userFlow = 'signUp'"
              class="button is-large is-fullwidth is-outlined is-success">
              Try it out!
            </button>
          </div>
        </div>
      </div> -->
      </div>

      <div
        class="background-section3 section is-fullheight"

        @scroll.window.throttle="isTransitioning2 = true"
        x-bind:class="{ 'changed': isTransitioning2 }">
        <h1>This is section 1</h1>
      </div>

      <!--             
            <div class="column">
              <span class="has-text-link is-size-5-mobile" style="font-size: 24pt">
                <p>- Keep track of your wines</p>
                <div style="margin-bottom: 10px"></div>
                <p>- Your previously tried wines</p>
                <div style="margin-bottom: 10px"></div>
                <p>- Information and thoughts</p>
                <div style="margin-bottom: 10px"></div>
                <p>- Tips on pairing</p>

                <div style="margin-bottom: 50px"></div>

                <div class="has-text-link is-hidden-tablet">
                  <div class="columns">
                    <div class="column is-narrow">
                      To get started
                      <a
                        class="button is-link is-small is-outlined is-rounded ml-3"
                        @click="accountModal.userFlow = 'signUp'">
                        <strong>Sign up</strong>
                      </a>
                    </div>
                    <div class="column"></div>
                  </div>
                </div>
                <div class="has-text-link is-hidden-mobile">
                  To get started
                  <a
                    class="button is-link is-small is-outlined is-rounded mt-3 ml-2"
                    @click="accountModal.userFlow = 'signUp'">
                    <strong>Sign up</strong>
                  </a>
                </div>
              </span>
            </div>
            <div class="column">
              <img
                src="assets/images/collction_yourcellarbook.png"
                alt="View of a wine collection"
                style="border: 1px solid green" />
              <div class="columns">
                <div class="column is-narrow"></div>
                <div class="column has-text-centered"><span class="">View of wine collaction</span></div>
                <div class="column is-narrow"></div>
              </div>
            </div> -->

      <!-- x-init="fetchStaticData() ; $watch('filter', val => filterWines());" -->
      <!-- <template x-init="await login(), getWines(), wineList.initFilteredWines; $watch('wineList.filter', val => wineList.filterWines());" x-if="selectedPage == 'home'"> -->
      <!-- x-init="wineList.initFilteredWines(); $watch('wineList.filtered_wines', list => console.log('fromInitinit', wineList.filtered_wines))" -->
      
        <template
          x-if="selectedPage == 'home' && isSignedIn"
          x-init="initFilteredWines() ; $watch('wineList.filter', val => filterWines());">
          <div><p class="has-text-white">adam</p></div>
          <section class="section">
            <div class="is-size-2 has-text-centered">All wines</div>
            <div class="columns">
              <div class="column"></div>
              <div class="column is-three-fifths">
                <div class="field">
                  <div class="control has-icons-right">
                    <input class="input is-rounded" type="text" placeholder="Find a wine" x-model="wineList.filter" />
                    <span class="icon is-small is-right">
                      <i class="fas fa-magnifying-glass"></i>
                    </span>
                  </div>
                </div>
              </div>
              <div class="column"></div>
            </div>

            <div class="container">
              <template x-for="wine in wineList.filteredWines">
                <div class="card">
                  <div class="container" @click="wine.open = !wine.open">
                    <div class="is-hidden-tablet m-1">
                      <header class="card-header">
                        <div class="card-header-title is-size-7">
                          <p x-text="wine.name" class="has-text-weight-semibold mr-1"></p>

                          <p x-text="wine.producer" class="has-text-weight-light mr-1"></p>

                          <p x-text="wine.vintage" class="has-text-weight-light"></p>
                        </div>
                        <div class="has-text-right">
                          <button class="card-header-icon has-text-right" aria-label="more options">
                            <span class="icon">
                              <i class="fas fa-angle-down" aria-hidden="true"></i>
                            </span>
                          </button>
                        </div>
                      </header>
                    </div>
                    <div class="columns m-2 is-hidden-mobile">
                      <div class="column is-narrow">
                        <p x-text="wine.vintage">col</p>
                      </div>
                      <div class="column">
                        <p class="has-text-weight-light" x-text="wine.producer"></p>
                      </div>
                      <div class="column">
                        <p class="has-text-weight-semibold" x-text="wine.name">col</p>
                      </div>
                      <button class="card-header-icon" aria-label="more options">
                        <span class="icon">
                          <i class="fas fa-angle-down" aria-hidden="true"></i>
                        </span>
                      </button>
                    </div>
                  </div>

                  <div class="card-content" x-show="wine.open">
                    <div class="content">
                      <div class="columns">
                        <div class="column">
                          <p class="subtitle is-3 is-size-5-mobile">Specification</p>
                          Wine name: <strong x-text="wine.name"></strong><br />
                          Producer: <strong x-text="wine.producer"></strong><br />
                          Vintage: <strong x-text="wine.vintage"></strong><br />
                          Region: <strong x-text="wine.region_name"></strong><br />
                          Country: <strong x-text="wine.country"></strong><br />
                          Grapes: <br />
                          <template x-for="grape in wine.grapes">
                            <div>
                              <em x-text="grape.name"></em>
                            </div>
                          </template>
                          <hr />
                          <span x-show="wine.storing_location != ''"
                            >Stored at: <strong x-text="wine.storing_location"></strong><br />
                          </span>

                          Quantity: <strong x-text="wine.quantity"></strong><br />
                        </div>
                        <div class="column is-two-thirds">
                          <p class="subtitle is-3 is-size-5-mobile">About the Wine</p>
                          <p x-show="wine.information == ''">
                            You haven't added any information about the wine. Click the 'Edit' button to write
                            something, e.g. where you heard about it or some information about the producer.
                          </p>
                          <p x-show="wine.information != ''" x-text="wine.information"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <footer class="card-footer" x-show="wine.open">
                    <a
                      href="#"
                      class="card-footer-item"
                      @click="editWineModal.open = !editWineModal.open, 
                                editWineModal.wine = wine"
                      >Edit</a
                    >
                    <a
                      href="#"
                      class="card-footer-item"
                      @click="drinkWineModal.open = !drinkWineModal.open, 
                                drinkWineModal.wine = wine">
                      Drink
                    </a>
                    <a href="#" class="card-footer-item" @click="getFoodSuggestion(wine)"> Get food suggestion </a>
                  </footer>
                </div>
              </template>
            </div>
            <template x-if="chat.modalOpen">
              <div class="modal" x-bind:class="{ 'is-active' : chat.modalOpen }">
                <div class="modal-background"></div>
                <div class="modal-content">
                  <div class="box">
                    <p class="subtitle has-text-danger is-size-3" x-text="chat.foodAnswer"></p>
                  </div>
                  <!-- Any other Bulma elements you want -->
                </div>
                <button
                  @click="chat.modalOpen = false; chat.foodAnswer=''"
                  class="modal-close is-large"
                  aria-label="close"></button>
              </div>
            </template>
            <template x-if="drinkWineModal.open">
              <div class="modal" x-bind:class="{ 'is-active' : drinkWineModal.open }">
                <div class="modal-background"></div>
                <div class="modal-card">
                  <header class="modal-card-head">
                    <p class="modal-card-title has-text-link-dark">
                      To Drink: <span x-text="drinkWineModal.wine.name"></span>
                    </p>
                    <button class="delete" aria-label="close" @click="drinkWineModal.open = false"></button>
                  </header>
                  <form @submit.prevent="drinkWine">
                    <section class="modal-card-body">
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Date</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <p class="control is-expanded">
                              <input class="input" type="date" x-model="drinkWineModal.formData.date" />
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Amount</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input class="input" type="number" min="1" x-model="drinkWineModal.formData.amount" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Rating</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="select is-expanded">
                              <select x-model="drinkWineModal.formData.rating">
                                <option value="" disabled selected>Rate the wine</option>
                                <option>Bad</option>
                                <option>Not that good</option>
                                <option>Quite decent</option>
                                <option>Very good</option>
                                <option>Great</option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Verdict</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <textarea
                                class="input"
                                type="textarea"
                                placeholder="Describe what you thought about the wine..."
                                x-model="drinkWineModal.formData.verdict"></textarea>
                            </div>
                          </div>
                        </div>
                      </div>
                    </section>
                    <footer class="field modal-card-foot">
                      <button @click="drinkWine" class="button is-link is-fullwidth">Drink wine</button>
                      <button
                        @click="drinkWineModal.wine = {}, drinkWineModal.open = false"
                        class="button is-light is-fullwidth"
                        type="button">
                        Cancel
                      </button>
                    </footer>
                  </form>
                </div>
              </div>
            </template>
            <template x-if="editWineModal.open">
              <div class="modal" x-bind:class="{ 'is-active' : editWineModal.open }">
                <div class="modal-background"></div>
                <div class="modal-card" @mousedown.outside="editWineModal.open = false">
                  <header class="modal-card-head">
                    <p class="modal-card-title has-text-link-dark">
                      Edit: <span x-text="editWineModal.wine.name"></span>
                    </p>
                    <button class="delete" aria-label="close" @click="editWineModal.open = false"></button>
                  </header>
                  <form @submit.prevent="updateWine">
                    <section class="modal-card-body">
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Name</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <p class="control is-expanded">
                              <input
                                class="input"
                                type="text"
                                x-bind:placeholder="editWineModal.wine.name"
                                x-model="editWineModal.formData.name" />
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Quantity</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input
                                class="input"
                                type="number"
                                x-bind:placeholder="editWineModal.wine.quantity"
                                x-model="editWineModal.formData.quantity" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Vintage</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input
                                class="input"
                                type="number"
                                x-bind:placeholder="editWineModal.wine.vintage"
                                x-model="editWineModal.formData.vintage" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Producer</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input
                                class="input"
                                type="text"
                                x-bind:placeholder="editWineModal.wine.producer"
                                x-model="editWineModal.formData.producer" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Region</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input
                                class="input"
                                type="text"
                                x-bind:placeholder="editWineModal.wine.region_name"
                                x-model="editWineModal.formData.region" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Country</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <input
                                class="input"
                                type="text"
                                x-bind:placeholder="editWineModal.wine.country"
                                x-model="editWineModal.formData.country" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="field is-horizontal">
                        <div class="field-label is-normal">
                          <label class="label">Information</label>
                        </div>
                        <div class="field-body">
                          <div class="field">
                            <div class="control">
                              <textarea
                                class="input"
                                type="textarea"
                                x-bind:placeholder="editWineModal.wine.information"
                                x-model="editWineModal.formData.information"></textarea>
                            </div>
                          </div>
                        </div>
                      </div>
                    </section>
                    <footer class="field modal-card-foot">
                      <button @click="updateWine" class="button is-link is-fullwidth">Save Changes</button>
                      <button
                        @click="editWineModal.wine = {}, editWineModal.open = false"
                        class="button is-light is-fullwidth"
                        type="button">
                        Cancel
                      </button>
                    </footer>
                  </form>
                </div>
              </div>
            </template>
          </section>
        </template>

        <template x-if="selectedPage == 'addWine'">
          <div class="columns is-centered">
            <div class="column is-two-thirds">
              <!-- <section class="section" x-data="AddWineComponent()"> -->
              <section class="section">
                <div class="card">
                  <header class="card-header">
                    <p class="card-header-title">Add a new wine to your collection</p>
                    <button class="card-header-icon" aria-label="more options">
                      <span class="icon">
                        <i class="fas fa-wine-bottle"></i>
                      </span>
                    </button>
                  </header>
                  <div class="card-content">
                    <div class="content">
                      <!-- <form @submit.prevent="submitForm" @keyup.enter="handleKeyboardEvent"> -->
                      <form @submit.prevent="submitForm">
                        <div class="field">
                          <label class="label">Name</label>
                          <input class="input" type="text" name="name" required x-model="addWineForm.name" />
                        </div>
                        <div class="field">
                          <label class="label">Vintage</label>
                          <input
                            class="input"
                            type="number"
                            min="1850"
                            name="vintage"
                            required
                            x-model="addWineForm.vintage" />
                        </div>
                        <div class="field">
                          <label class="label">Producer</label>
                          <input class="input" type="text" name="producer" required x-model="addWineForm.producer" />
                        </div>

                        <!-- <div class="field">
                        <label class="label">Region:</label>
                        <input class="input" type="text" name="region" required x-model="addWineForm.region" />
                        <input class="input" type="text" name="country" required x-model="addWineForm.country" />
                    </div> -->

                        <div
                          class="field"
                          x-init="filterRegions; $watch('regionPicker.filter', val => filterRegions())">
                          <div class="field-body">
                            <div class="field">
                              <label class="label">Region</label>
                              <!-- <span class="has-text-weight-light" x-text="addWineForm.region"></span> -->
                              <div class="control">
                                <input class="input" type="text" required x-model="regionPicker.filter" />
                                <div class="dropdown" x-bind:class="{ 'is-active' : regionPicker.open }">
                                  <div
                                    class="dropdown-menu"
                                    id="dropdown-menu"
                                    role="menu"
                                    x-show="regionPicker?.filter?.length >= 1 && regionPicker.filteredRegions.length > 0 ">
                                    <div class="dropdown-content">
                                      <template x-for="(region, index) in regionPicker.filteredRegions" :key="index">
                                        <!-- <a @click="addGrapeToSelection(grape)" @keyup.enter="addGrapeToSelection(grape)"  class="dropdown-item" x-text="grape.name" x-bind:class="grapePicker.active == index ? '{ is-active }' : ''"></a> -->
                                        <a @click="handleSelectRegion(region)" class="dropdown-item">
                                          <span x-text="region.region_name"></span>
                                          <span> ( </span>
                                          <span x-text="region.country"></span>
                                          <span> ) </span>
                                        </a>
                                      </template>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <div class="field">
                              <label x-data="{partOfWorld: 'Nation'}" class="label" x-text="partOfWorld"></label>
                              <p class="control">
                                <input class="input" type="text" required x-model="addWineForm.country" />
                              </p>
                            </div>
                          </div>
                        </div>

                        <!-- <button class="button is-link is-light is-small" x-text="grapePicker.grape"></button> -->
                        <!-- <div
                        x-init="fetchGrapes(); filterGrapesStart(); $watch('grapePicker.grapeFilter', val => filterGrapes())">
                        <div class="field">
                          <label class="label">Grapes: </label>
                          <template x-for="grape in addWineForm.grapes">
                            <span>
                              <button
                                @click="removeSelectedGrape(grape)"
                                class="ml-1 mb-1 mt-0 pr-1 button is-small is-light is-link is-rounded"
                                style="border: 1.5px solid transparent; display: inline-block; position: relative">
                                <span x-text="grape.name"></span>
                                <i class="bx bx-x bx-xs"></i>
                              </button>
                            </span>
                          </template>
                          <div class="control">
                            <input
                              class="input"
                              type="text"
                              name="grape"
                              required
                              placeholder=""
                              x-model="grapePicker.grapeFilter" />
                            <div x-show="grapePicker?.grapeFilter?.length >= 1 && grapePicker.filteredGrapes.length > 0" class="select">
                              <select class="is-active">
                                <template x-for="grape in grapePicker.filteredGrapes">
                                  <option x-text="grape.name"></option>
                                </template>
                              </select>
                            </div>
                          </div>
                        </div> -->

                        <!-- x-init="fetchGrapes(); filterGrapesStart(); $watch('grapePicker.grapeFilter', val => filterGrapes()) ;$watch('grapePicker.active', value => console.log(value))"> -->
                        <div
                          class="field"
                          x-init="filterGrapes; $watch('grapePicker.grapeFilter', val => filterGrapes())">
                          <label class="label">Grapes </label>
                          <template x-for="grape in addWineForm.grapes">
                            <span>
                              <button
                                @click="removeSelectedGrape(grape)"
                                class="ml-1 mb-1 mt-0 pr-1 button is-small is-light is-grey is-rounded">
                                <span class="has-text-link" x-text="grape.name"></span>
                                <i class="pl-1 pb-2 bx bx-x bx-xs"></i>
                              </button>
                            </span>
                          </template>

                          <!-- <div class="control"> -->
                          <!-- <input class="input" type="text" placeholder="test"> -->
                          <input
                            class="input"
                            type="text"
                            name="grape"
                            placeholder=""
                            x-model="grapePicker.grapeFilter" />
                          <!-- @keyup="handleKeyboardEvent" -->
                          <div class="dropdown is-active">
                            <div
                              class="dropdown-menu"
                              id="dropdown-menu"
                              role="menu"
                              x-show="grapePicker?.grapeFilter?.length >= 1 && grapePicker.filteredGrapes.length > 0">
                              <div class="dropdown-content">
                                <template x-for="(grape, index) in grapePicker.filteredGrapes" :key="index">
                                  <!-- <a @click="addGrapeToSelection(grape)" @keyup.enter="addGrapeToSelection(grape)"  class="dropdown-item" x-text="grape.name" x-bind:class="grapePicker.active == index ? '{ is-active }' : ''"></a> -->
                                  <a @click="addGrapeToSelection(grape)" class="dropdown-item" x-text="grape.name"></a>
                                </template>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- <div class="field" @sel-event="console.log($event.detail); grapePicker.grape = $event.detail">
                          <div class="buttons">
                            <template x-for="grape in grapePicker.grapes.sub" :key="grape">
                              <button @click="" class="button">
                                <span x-text="grapePicker.grape"></span>
                              </button>
                            </template>
                          </div>
                        </div> -->

                        <!-- <div x-if="isAdminUser">
                        <div class="field has-addons">
                          <div class="label">Add new grapes:</div>
                          <div class="input" type="text" name="newGrape" required x-model="formData.newGrape"></div>
                          <div class="control">
                            <a class="button is-info"> Search </a>
                          </div>
                        </div> -->

                        <div class="field">
                          <label class="label">Wine Type</label>
                          <div class="select is-fullwidth" x-model="addWineForm.category">
                            <select>
                              <option value="" disabled selected>Select Type</option>
                              <option>Red</option>
                              <option>White</option>
                              <option>Rosé</option>
                              <option>Sparkling</option>
                              <option>Sweet</option>
                              <option>Orange</option>
                              <option>Fortified</option>
                            </select>
                          </div>
                        </div>
                        <div class="field">
                          <div class="field-body">
                            <div class="field">
                              <label class="label">Stock (Bottles)</label>
                              <p class="control is-expanded">
                                <input class="input" type="number" name="quantity" x-model="addWineForm.quantity" />
                              </p>
                            </div>
                            <div class="field">
                              <label class="label">Purchase Price (SEK)</label>
                              <p class="control">
                                <input
                                  class="input"
                                  type="number"
                                  name="purchase_price"
                                  x-model="addWineForm.details.purchase_price" />
                              </p>
                            </div>
                          </div>
                        </div>

                        <div class="field">
                          <label class="label">Information</label>
                          <textarea
                            class="textarea"
                            placeholder="Describe what you know about the wine and the producer..."
                            name="information"
                            x-model="addWineForm.details.information">
                          </textarea>
                        </div>

                        <!-- <p>* Required field</p> -->

                        <div class="field is-grouped is-grouped-right">
                          <div class="control">
                            <button class="button is-link is-light">Cancel</button>
                          </div>
                          <div class="control">
                            <button @click="doAddWine;" class="button is-link">Submit</button>
                          </div>
                        </div>
                      </form>

                      <!-- <div x-text="formMessage"></div> -->
                    </div>
                  </div>
                </div>
              </section>
            </div>
          </div>
        </template>
        <template x-if="selectedPage == 'pairWine'">
          <div class="container mt-5 pt-5">
            <div class="field">
              <label class="label">Question about wine</label>
              <div class="control">
                <textarea x-model="chat.question" class="textarea" placeholder="Textarea"></textarea>
              </div>
            </div>
            <div class="field is-grouped">
              <div class="control">
                <button @click="handleWineQuestion" class="button is-link">Submit</button>
              </div>
              <div class="control">
                <button @click="getWineSuggestion" class="button is-success">Suggest</button>
              </div>
              <div class="control">
                <button class="button is-link is-light">Cancel</button>
              </div>
            </div>
            <div class="field is-grouped">
              <p class="subtitle has-text-danger" x-text="chat.answer"></p>
            </div>
          </div>
        </template>
      </div>
    
  </body>
</html>
